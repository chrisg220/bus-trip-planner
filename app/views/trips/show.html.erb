<div class="btn-group">
  <button class="btn">Actions</button>
  <button class="btn dropdown-toggle" data-toggle="dropdown">
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><%= link_to "Save Trip", save_trip_path(@trip) %></li>
    <li><%= link_to "Edit", edit_trip_path(@trip) %></li>
    <li><%= link_to "Delete", trip_path(@trip), :method => :delete, :data => { :confirm => "Are you sure you want to delete this trip?" } %></li>
  </ul>
</div>


<div id="trip" class="content">
  Here we show our Route objets: (# of routes = <%= @trip.routes.length %>)

  <ul id="routes">
  <% @trip.routes.each do |route| %>
    <li>
      <span class="snapshot"><%= route[:snapshot] %></span>
      Start time: <%= route[:start_time] if (route[:start_time] > 0) %><br/>
      End time: <%= route[:end_time] if (route[:end_time] > 0) %>

      <% json = JSON.parse(route[:response]) %>
      <ul class="steps">
      <% json.each do |step| %>
        <li>
          #<%= step["line"] %>
          <%= step["html_instructions"] %><br/>
          Duration: <%= step["duration"] %>
          <%= real_time_container(step) %>
        </li>
      <% end %>
      </ul>
    </li>
  <% end %>
  </ul>
</div>

<div class="content">
<h2>Directions to <%= @trip.name %></h2>
  <% if @json %>
    <% @json["routes"].each_with_index do |route, index| %>
      <h3>Route <%= index+1 %>:</h3>
      <p>Start: <%= route["legs"][0]["start_address"] %></p>
      <p>End: <%= route["legs"][-1]["end_address"] %></p>
      <p>Steps:</p>
      <ol>
        <% route["legs"].each do |leg| %>
          <% leg["steps"].each do |step| %>
            <li>
              <strong><%= step["travel_mode"] %></strong>
              <%= step["html_instructions"] %>
              <% if step["transit_details"] %>
                <br/>
                Get on
                <strong><%= step["transit_details"]["line"]["short_name"] || step["transit_details"]["line"]["name"]%>
                <%= " " + step["transit_details"]["line"]["vehicle"]["name"] %></strong> at <strong><%= step["transit_details"]["departure_stop"]["name"] %></strong>
                and get off at <strong><%= step["transit_details"]["arrival_stop"]["name"] %></strong>
              <% end %>
            </li>
          <% end %>
        <% end %>
      </ol>
      <p><%= route["copyrights"] %></p>
    <% end %>

    <h4>Raw JSON</h4>
    <%= @resp %>
  <% end %>
</div>
